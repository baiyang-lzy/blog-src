
俗话说：好马配好鞍。最近获得了一台新电脑 Thinbook 16 G4+，但是它原装的是 Windows 11。本来，我用 Windows 平台的一大理由就是腾讯会议的 Linux 版本有无数不支持的功能，这无疑会为我的网课带来许多尴尬，但是，因为下周就线下复课了，所以腾讯会议也可以暂时抛弃了，因此为什么不试一试 Linux 呢？

对于我来说，在发行版上选择 Ubuntu 22.04 的原因如下：

* 内核、固件、驱动等版本比较新，并且自带许多闭源驱动，从而减少硬件不兼容的概率 ~~虽然事实证明还是很不兼容~~
* 支持安全启动 ~~然而最后为了安装第三方驱动还是需要关掉~~

值得一提的是，我用的这台电脑没有带独显，因此这里不考虑 Nvidia 显卡支持。

## 开始之前

在系统设置->显示器中打开 Fractional Scaling （非整数倍缩放），然后修改显示器的缩放为 150%（或者你认为合适的值）。

在系统设置->电源中暂时关闭“自动挂起”，并将挂起或关屏时间暂时修改到“3小时”。因为现在我们还没有安装 OEM 内核，自带内核还没有适配好硬件，一旦锁屏或挂起就无法正常唤醒。

## 编译安装 RTL8852BE 无线网卡驱动

本来我以为 Ubuntu 22.04 应该可以兼容大部分的硬件，实际上你会发现最基本的无线网卡都不能兼容。

**在进行下列过程时，你需要设法先使电脑获得一个有效的网络环境。我的方法是，将安卓手机与电脑USB口相连，U并在手机上的USB选项中选择“提供网络连接”来达到手机与电脑的网络共享。蓝牙在这个场景下不可行，虽然它也能传输网络信号，但是至少在我这里蓝牙驱动也不能正常工作。**

那么获得网络连接之后，可以进行无线网卡驱动的编译安装了。首先```sudo apt update && sudo apt install build-essential bc git```进行必要的准备，然后确保当前内核的linux-header已经安装（包名linux-headers-xxx，关于这个xxx是什么，应该用uname -a去获取）。

然后参看这个仓库：```https://github.com/HRex39/rtl8852be```，并按照里面的步骤编译安装。注意Ubuntu 22.04自带的内核版本是5.15，需要参看的是**Build(for kernel >= 5.15)**这一段，如果版本对应错将无法编译。

之后每次更换内核都需要在你克隆的rtl8852be仓库文件夹中执行一次```sudo make clean```和仓库文档中的编译安装过程。（或者，你可以设法自动化这段过程。）

## 更换 OEM 内核

自带内核还没有适配好硬件，一旦锁屏或挂起就无法正常唤醒。我们需要更换到 OEM 内核，它提供了 Xe 核显的更好支持，解决了关屏无法唤醒的问题。

```
sudo apt install linux-oem-22.04
```

检查一下oem内核的linux-header是否也连带安装了，如果没有，手动安装它。

重启生效。

## 修改内核启动参数来解决闪屏问题

重启后你会发现系统出现闪屏现象。这是因为面板自我刷新功能存在的问题导致的。

这时需要编辑```/etc/default/grub```并在```GRUB_CMDLINE_LINUX_DEFAULT="quiet splash"```的引号内添加```i915.enable_psr=0```，然后别忘了```sudo update-grub```，重启生效。

## 其它问题

目前对我影响最大的几个问题已经解决，目前 Thinkbook 16 G4+对桌面 Linux 的支持还不是很好，如果希望稳定的话还是可以等等下半年的 Ubuntu 22.10。
